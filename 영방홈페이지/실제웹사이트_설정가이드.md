# 실제 웹사이트 설정 가이드

수정된 `index.html` / `style.css` / `script.js` + `config.js` / `api.js` 는 **로컬 모드**와 **Supabase 모드** 둘 다 지원합니다.

---

## 1. 로컬 모드 (바로 사용)

- `config.js` 에서 `SUPABASE_URL`, `SUPABASE_ANON_KEY` 를 **비워 두면** 자동으로 **로컬 모드**입니다.
- 데이터는 브라우저 **localStorage**에 저장됩니다.
- `index.html` 을 브라우저로 열거나, 로컬 서버로 띄우면 됩니다.
- 테스트 계정: 학번 `20240001` / 비밀번호 `demo123`

---

## 2. Supabase 모드 (실제 웹사이트)

### 2-1. Supabase 프로젝트 만들기

1. [supabase.com](https://supabase.com) 에서 로그인 후 **New Project** 생성.
2. 프로젝트가 준비되면 **Settings → API** 에서 다음 값을 복사:
   - **Project URL** → `config.js` 의 `SUPABASE_URL`
   - **anon public** 키 → `config.js` 의 `SUPABASE_ANON_KEY`

### 2-2. DB 스키마 적용

1. Supabase 대시보드 **SQL Editor** 로 이동.
2. 이 폴더의 **`supabase-schema.sql`** 내용을 붙여넣고 **Run** 으로 실행.
3. `profiles`, `videos`, `video_likes`, `comments` 테이블과 RLS 정책이 생성됩니다.

### 2-3. 이메일 인증 설정 (학번 로그인)

- 로그인은 **이메일 = 학번 + `@filmarchive.local`** 로 사용합니다.
- **Authentication → Providers → Email** 에서 **Confirm email** 을 **끄면** 가입 후 바로 로그인 가능합니다. (선택)

### 2-4. config.js 수정

```javascript
window.ARCHIVE_CONFIG = {
    SUPABASE_URL: 'https://여기에프로젝트ID.supabase.co',
    SUPABASE_ANON_KEY: '여기에_anon_키',
    DEBUG: false  // 필요 시 true 로 로그 확인
};
```

저장 후 페이지를 새로고침하면 **Supabase 모드**로 동작합니다.

---

## 3. 배포 (Netlify / Vercel 등)

1. 이 폴더 전체를 Git 저장소에 올리거나, Netlify/Vercel 에 연결.
2. **Supabase 모드**로 쓸 경우, 배포 환경에서도 같은 `config.js` 값이 적용되도록 하거나, 빌드 시 환경 변수로 주입하세요.
3. **HTTPS** 로 서비스하는 것을 권장합니다.

---

## 4. 적용된 수정 사항 요약

| 항목 | 적용 내용 |
|------|-----------|
| 데이터 저장소 | Supabase 연동 + 미설정 시 localStorage 폴백 |
| 인증 | Supabase Auth(비밀번호 해시) 또는 로컬 로그인 |
| XSS 방지 | 사용자 입력은 `escapeHtml()` 처리 후 출력 |
| 회원가입 | 로그인 모달 내 회원가입 탭 + 비밀번호 확인 |
| 에러 처리 | API 실패 시 전역 메시지 표시 |
| 로딩 | 요청 중 로딩 오버레이 표시 |
| 환경 설정 | `config.js` 로 URL/키 분리 |

---

문제가 있으면 브라우저 개발자 도구(F12) → Console 탭에서 에러 메시지를 확인하세요.

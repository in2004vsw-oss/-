# 실제 웹사이트 구현을 위한 수정 사항

현재 **영방홈페이지**는 브라우저의 LocalStorage만 사용하는 **프로토타입** 수준입니다.  
실제 서비스처럼 “어디서든 접속하고, 데이터가 유지되고, 여러 사용자가 함께 쓰는” 웹사이트로 만들려면 아래 항목들이 필요합니다.

---

## 1. 데이터 저장소 전환 (필수)

### 현재 문제
- **LocalStorage** 사용 → 기기·브라우저마다 데이터가 따로 존재
- 다른 사람과 데이터 공유 불가, 브라우저 삭제 시 데이터 소실
- 용량 제한(약 5~10MB)

### 필요한 수정
- **백엔드 서버 + DB** 또는 **BaaS(Backend as a Service)** 도입

| 방식 | 설명 | 난이도 |
|------|------|--------|
| **Supabase** | PostgreSQL + REST API + 인증, 무료 티어 있음 | 중 |
| **Firebase** | 실시간 DB + 인증 + 스토리지 | 중 |
| **자체 서버** (Node.js + Express + MySQL/PostgreSQL 등) | 완전 자유도, 호스팅·관리 필요 | 상 |

### 코드 수정 포인트
- `script.js`의 `getUsers()`, `getVideos()`, `saveVideos()`, `getCurrentUser()` 등 **모든 LocalStorage 접근**을 **API 호출**로 교체
- 영상 목록 로딩: 페이지 로드 시 서버에서 목록 조회
- 업로드/수정/삭제: 서버 API 호출 후 성공 시 화면 갱신
- 좋아요/댓글/조회수: 서버에 저장 후 다시 불러오기

---

## 2. 인증(로그인) 보안 (필수)

### 현재 문제
- 비밀번호 **평문 저장** (`password: 'demo123'`)
- 로그인 여부만 클라이언트에서 판단 → 조작 가능
- 서버가 없어서 “진짜 로그인”이 아님

### 필요한 수정
1. **비밀번호 해시 저장**
   - 서버 또는 Supabase/Firebase 인증 사용 시 비밀번호는 **절대 평문 저장 금지**
   - bcrypt 등으로 해시 후 저장, 로그인 시 비교만 수행
2. **서버 측 세션 또는 JWT**
   - 로그인 성공 시 서버가 세션 ID 또는 JWT 발급
   - 이후 API 요청마다 이 토큰을 보내서 “누가 요청했는지” 서버가 검증
3. **업로드/댓글 등 권한**
   - “로그인한 사용자만 업로드” 등은 **반드시 서버 API에서 한 번 더 체크**

---

## 3. XSS(크로스 사이트 스크립팅) 방지 (권장)

### 현재 문제
- `innerHTML`에 **사용자 입력**을 그대로 넣고 있음  
  - 예: 댓글 `comment.content`, 영상 `title`, `director`, `description` 등
- 악의적인 스크립트(`<script>`, `onerror=` 등) 입력 시 다른 사용자 브라우저에서 실행될 수 있음

### 필요한 수정
1. **HTML 이스케이프 함수** 추가 후, 사용자 입력을 넣기 전에 항상 이스케이프  
   - 예: `<` → `&lt;`, `"` → `&quot;` 등
2. **가능한 경우 `textContent` 사용**  
   - 댓글 내용, 제목 등 “글자만” 보여주는 곳은 `textContent`로 넣고, `innerHTML` 사용 최소화
3. **영상 카드/상세 페이지**  
   - 제목, 감독, 설명 등도 이스케이프 후 삽입하거나, 텍스트 노드로만 넣기

---

## 4. 배포(호스팅) 설정

### 현재 상태
- `index.html`을 로컬에서 열거나, 정적 파일만 올리면 “사이트”는 동작하지만, 데이터는 여전히 각자 LocalStorage에만 있음

### 실제 웹사이트로 만들 때
1. **정적 파일 배포**
   - **Netlify / Vercel / GitHub Pages** 등에 `index.html`, `style.css`, `script.js` 업로드
   - 백엔드를 Supabase/Firebase로 둘 경우: 프론트만 여기서 서비스
2. **API 주소 설정**
   - `script.js`에 **API 기본 URL**을 상수 또는 설정으로 두기  
     예: `const API_BASE = 'https://your-api.com'` 또는 환경 변수
   - 배포 환경별로 다른 URL 쓸 수 있게 (개발/운영 분리)
3. **도메인·HTTPS**
   - 실제 서비스는 **HTTPS** 사용 (로그인·쿠키 보안)
   - 도메인 연결 시 `https://영방아카이브.학교도메인.ac.kr` 형태로 사용 권장

---

## 5. 환경별 설정 분리

### 필요한 수정
- **개발**과 **운영**에서 다른 설정 쓰기
  - 개발: `http://localhost:3000` 또는 로컬 API
  - 운영: `https://실제도메인.com`, 실제 API URL
- 방법 예시
  - `config.js`에서 `API_BASE`, 로그 사용 여부 등 읽기
  - 또는 빌드 도구(예: Vite) 사용 시 `import.meta.env.VITE_API_URL` 같은 환경 변수 사용

---

## 6. 회원가입 기능 (선택)

### 현재
- 로그인 폼만 있고, **회원가입(가입 폼)** 은 없음  
- 데이터 가이드에는 “회원가입 탭”이 있다고 되어 있으나, 실제 `index.html`에는 없음

### 실제 서비스 시
- 새 학번/이름/비밀번호로 **가입** → 서버 또는 Supabase Auth에 사용자 생성
- 가입 후 로그인하도록 연결
- 필요 시 “학번 인증”(이메일·학교 시스템 연동)은 별도 기획

---

## 7. 에러 처리 및 사용자 안내

### 현재
- `alert()` 위주, 네트워크 실패 등에 대한 처리 부족

### 필요한 수정
- API 호출 시 **실패(4xx, 5xx)** 처리
  - “잠시 후 다시 시도해 주세요”, “로그인이 필요합니다” 등 메시지
- 로딩 중 표시 (스피너, 버튼 비활성화)
- 오프라인/네트워크 끊김 시 안내 (선택)

---

## 8. 관리자 페이지(admin.html) 보안

### 현재
- `admin.html`이 그대로 노출되면, 로컬에서는 LocalStorage를 그대로 건드릴 수 있음

### 실제 서비스 시
- 관리자 기능은 **서버 API**로만 수행 (영상 삭제, 회원 관리 등)
- **관리자 권한**은 서버에서 “현재 로그인 사용자가 관리자인지” 확인
- 관리자 페이지 자체도 **로그인 필수** 또는 **별도 관리자 인증** 후에만 접근 가능하도록 설계

---

## 9. 체크리스트 요약

| 구분 | 항목 | 우선순위 |
|------|------|----------|
| 데이터 | LocalStorage → 서버 DB 또는 Supabase/Firebase 전환 | 필수 |
| 인증 | 비밀번호 해시 + 서버 세션/JWT, 업로드/댓글 권한 검증 | 필수 |
| 보안 | 댓글·제목 등 사용자 입력 이스케이프(XSS 방지) | 권장 |
| 배포 | 정적 호스팅(Netlify 등) + API URL·HTTPS 설정 | 필수 |
| 설정 | 개발/운영 API URL 분리 | 권장 |
| 기능 | 회원가입 폼 추가 | 선택 |
| UX | API 에러 처리, 로딩 표시 | 권장 |
| 관리 | admin 기능 서버화·권한 체크 | 필수(운영 시) |

---

## 10. 권장 진행 순서

1. **백엔드 선택**  
   - Supabase 추천: 무료 티어, 인증·DB·REST API 한 번에 처리 가능
2. **DB 스키마 설계**  
   - `users`, `videos`, `comments`, `likes` 테이블 등 (가이드의 JSON 구조 참고)
3. **API 설계**  
   - 로그인, 영상 목록/상세, 업로드, 댓글, 좋아요 등 엔드포인트 정의
4. **script.js 리팩터링**  
   - 데이터 읽기/쓰기를 전부 API 호출로 교체, 인증 토큰 헤더에 포함
5. **인증 연동**  
   - Supabase Auth 또는 자체 로그인 API + JWT 적용
6. **XSS 방지**  
   - 사용자 입력 출력 시 이스케이프 또는 `textContent` 적용
7. **배포**  
   - Netlify/Vercel에 배포, API URL을 운영 환경에 맞게 설정
8. **관리자**  
   - admin 기능을 API 기반으로 옮기고, 관리자 권한 체크 추가

이 순서대로 적용하면, 현재 코딩을 “실제 웹사이트”에 가깝게 단계적으로 올릴 수 있습니다.
